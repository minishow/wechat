<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com._520it.crm.mapper.PayMapper">
    <resultMap id="BaseResultMap" type="com._520it.crm.domain.Pay">

    </resultMap>


    <sql id="baes_where">
        <where>
            <if test="keyword!=null">
                and e.name like concat('%',#{keyword},'%')
            </if>
        </where>
    </sql>

    <select id="selectByCount" resultType="long">
        select count(e.jobNumber)
        from employee e
        LEFT JOIN position p on e.position_id = p.id
        JOIN leaverecord le on le.employee_id = e.id
        <include refid="baes_where"/>
    </select>

    <select id="selectByPageList" resultMap="BaseResultMap">
        select e.jobNumber,e.name,e.basePay,
        p.jobSubsidys,p.travelAllowance,p.airtimeSubsidy,p.meaSubsidy,p.attendanceBonus,p.commissionRate,
        le.days
        from employee e
        LEFT JOIN position p on e.position_id = p.id
        JOIN leaverecord le on le.employee_id = e.id
        <include refid="baes_where"/>
        group by e.jobNumber
        limit #{start},#{rows}
    </select>
</mapper>